<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Property Valuation Calculator</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<style>
  /* Global Styles & Body */
  body {
    font-family: 'Roboto', Arial, sans-serif; /* Using Roboto for a clean look */
    margin: 0;
    background-color: #f0f2f5; /* Light grey background, common in modern UIs */
    color: #333;
    padding-bottom: 50px; /* Space at the bottom */
  }

  /* Header Bar */
  .header-bar {
    background-color: #007bff; /* Deep blue, common for government sites */
    color: white;
    padding: 15px 20px;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    margin-bottom: 30px;
  }
  .header-bar h1 {
    margin: 0;
    font-size: 1.8em;
  }

  /* Logo Container */
  .logo-container {
    text-align: center;
    padding: 20px 0;
    background-color: white;
    border-bottom: 1px solid #e0e0e0;
  }
  .logo-container img {
    max-width: 100%;
    height: auto;
    width: 550px; /* Specific width as provided */
  }

  /* Main Content Wrapper */
  .container {
    max-width: 900px;
    margin: 0 auto;
    padding: 0 20px;
  }

  h2 {
    margin-top: 30px;
    color: #0056b3; /* Darker blue for headings */
    border-bottom: 2px solid #007bff;
    padding-bottom: 8px;
    margin-bottom: 20px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 15px;
    background-color: white;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1); /* Subtle shadow for tables */
    border-radius: 8px; /* Slightly rounded corners */
    overflow: hidden; /* Ensures rounded corners apply to content */
  }
  th, td {
    border: 1px solid #dee2e6; /* Lighter border for tables */
    padding: 10px;
    text-align: center;
  }
  th {
    background-color: #e9ecef; /* Light grey header for tables */
    font-weight: bold;
    color: #495057;
  }
  td {
      background-color: white; /* Ensure cell backgrounds are white */
  }

  select, input[type=number], input[type=text] { /* Added text type for land area for consistency */
    width: calc(100% - 12px); /* Adjust for padding */
    padding: 8px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
    margin-top: 5px;
    margin-bottom: 5px;
  }
  select {
      width: 100%; /* Full width for select boxes */
  }

  button {
    padding: 10px 20px;
    margin-top: 15px;
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.2s ease;
  }
  button:hover {
    background-color: #0056b3;
  }
  button:active {
    background-color: #004085;
  }

  .result {
    font-weight: bold;
    font-size: 1.1em;
    margin-top: 20px;
    padding: 15px;
    background-color: #e2f0fb; /* Light blue background for results */
    border: 1px solid #b3d9ff;
    border-radius: 8px;
    text-align: center;
  }
  .highlight {
    background-color: #d4f4dd; /* Light green for highlighting */
    border-color: #a3e0b7;
  }
  .section-header td {
    background-color: #f8f9fa; /* Lighter background for section headers within tables */
    font-weight: bold;
    text-align: left !important;
    padding-top: 15px;
    color: #495057;
  }

  /* Style for the calculator sections */
  .calculator-section {
    background-color: white;
    border: 1px solid #e0e0e0;
    padding: 20px;
    margin-top: 30px;
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .input-group {
    display: flex;
    align-items: center;
    margin-bottom: 10px;
  }
  .input-group label {
    flex: 1;
    text-align: right;
    margin-right: 15px;
    font-weight: bold;
    color: #555;
  }
  .input-group input {
    flex: 2;
    max-width: 200px; /* Slightly wider input for number fields */
    margin-right: 5px;
  }
  .input-group span {
    flex: 0 0 80px; /* Fixed width for unit text */
    text-align: left;
    font-weight: bold;
    color: #666;
  }
  .output-field {
      font-weight: bold;
      margin-top: 15px;
      padding: 10px;
      border: 1px solid #cce7ff;
      background-color: #e2f0fb; /* Light blue output field */
      text-align: center;
      border-radius: 5px;
      color: #0056b3;
  }
  .explanation-text {
      font-size: 0.9em;
      color: #555;
      margin-bottom: 20px;
      line-height: 1.5;
      background-color: #f8f9fa;
      padding: 15px;
      border-left: 4px solid #007bff;
      border-radius: 4px;
  }
  #rateChartContainer {
      margin-top: 40px;
      padding: 20px;
      background-color: #e9f5ff; /* Light blue background for clarity */
      border: 1px solid #cce7ff;
      border-radius: 8px;
  }
  #rateChartContainer table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
  }
  #rateChartContainer th, #rateChartContainer td {
      border: 1px solid #a0d8ff; /* Darker blue border */
      padding: 8px;
      text-align: left;
  }
  #rateChartContainer th {
      background-color: #cce7ff; /* Lighter blue header */
      font-weight: bold;
      color: #0056b3;
  }

  /* Specific styles for the land area input (to make it look like a regular input) */
  #landArea {
      width: 180px; /* Adjust width as needed */
      margin-left: 10px;
  }
  .land-input-group {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
  }
  .land-input-group label {
      font-weight: bold;
      color: #555;
      margin-right: 10px;
  }
</style>
</head>
<body>

<div class="logo-container">
    
</div>

<div class="header-bar">
    <h1>Property Valuation Calculator</h1>
</div>

<div class="container">

    <h2>Floors Information</h2>
    <table id="floorsTable">
      <thead>
        <tr>
          <th>Floor No.</th>
          <th>Construction Type</th>
          <th>Floor Level</th>
          <th>Area (sqft)</th>
          <th>Cost Rate (₹/sqft)</th>
          <th>Cost Total (₹)</th>
          <th>Rental Rate (₹/sqft)</th>
          <th>Rental Total (₹)</th>
          <th>Remove</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button onclick="addFloor()">Add New Floor</button>

    ---

    <div class="calculator-section">
        <h2>Area Arithmetic Calculator (Add / Subtract Multiple Units)</h2>
        <p class="explanation-text">
            Use this tool to precisely calculate the total land area in square feet by adding or subtracting different land units.
            <br>
            &#x2022; Enter **positive** values for areas you wish to **add** (e.g., `1` for 1 Bigha).
            <br>
            &#x2022; Enter **negative** values for areas you wish to **subtract** (e.g., enter `-1` in the 'Katha' field to subtract 1 Katha).
            <br>
            The calculated total in Square Feet will automatically update the "Land Area (sqft)" field below, ensuring it's ready for valuation.
        </p>

        <div class="input-group">
            <label for="arithmeticBigha">Bigha:</label>
            <input type="number" id="arithmeticBigha" value="0" oninput="calculateArithmeticArea()" />
            <span>Bigha</span>
        </div>

        <div class="input-group">
            <label for="arithmeticKatha">Katha:</label>
            <input type="number" id="arithmeticKatha" value="0" oninput="calculateArithmeticArea()" />
            <span>Katha</span>
        </div>

        <div class="input-group">
            <label for="arithmeticChattak">Chattak:</label>
            <input type="number" id="arithmeticChattak" value="0" oninput="calculateArithmeticArea()" />
            <span>Chattak</span>
        </div>

        <div class="input-group">
            <label for="arithmeticSqft">Square Feet:</label>
            <input type="number" id="arithmeticSqft" value="0" oninput="calculateArithmeticArea()" />
            <span>Sq.Ft.</span>
        </div>

        <div id="arithmeticResult" class="output-field">Calculated Total Area: 0.00 Sq.Ft.</div>
    </div>

    ---

    <h2>Land Details (For Cost Basis)</h2>
    <div class="land-input-group">
      <label for="landArea">Land Area (sqft):</label>
      <input type="number" id="landArea" value="0" min="0" readonly />
    </div>
    <br />
    <label>
      Ward No.:
      <select id="wardNo"></select>
    </label>
    <br /><br />
    <label>
      Passage Width (meters):
      <select id="passageWidth">
        <option value="3.5">Less than 3.5m</option>
        <option value="3.5-7">3.5 to 7.0m</option>
        <option value="7.01-10">7.01 to 10m</option>
        <option value="10.01-15">10.01 to 15m</option>
        <option value="15.01+">Above 15.01m</option>
      </select>
    </label>

    <br /><br />
    <button onclick="calculate()">Calculate Valuation</button>
    <button onclick="toggleRateChart()">View Full Rate Chart</button>

    <div id="result"></div>

    ---

    <div id="rateChartContainer" style="display: none;">
        <h2>Full Rate Chart</h2>

        <h3>Structure Construction Rates (₹/sqft)</h3>
        <table id="structureRatesTable">
            <thead>
                <tr>
                    <th>Construction Type</th>
                    <th>Ground Floor Cost</th>
                    <th>1st & Above Cost</th>
                    <th>Rental Rate</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>

        <h3>Land Rates (₹/Katha)</h3>
        <table id="landRatesTable">
            <thead>
                <tr>
                    <th>Ward Group</th>
                    <th>Passage &lt;3.5m</th>
                    <th>Passage 3.5-7m</th>
                    <th>Passage 7.01-10m</th>
                    <th>Passage 10.01-15m</th>
                    <th>Passage &gt;15.01m</th>
                </tr>
            </thead>
            <tbody>
                </tbody>
        </table>
    </div>

</div> <script>
  // Constants for conversion (specific to Bengal/Bihar Bigha, Katha, Chattak)
  const SQFT_PER_CHATTAK = 45;
  const CHATTAK_PER_KATHA = 16;
  const KATHA_PER_BIGHA = 20;
  const SQFT_PER_KATHA = CHATTAK_PER_KATHA * SQFT_PER_CHATTAK; // 16 chattak * 45 sqft/chattak = 720 sqft
  const SQFT_PER_BIGHA = KATHA_PER_BIGHA * SQFT_PER_KATHA; // 20 katha * 720 sqft/katha = 14400 sqft


  const structureRates = {
    cost: {
      "RCC with Marble": { ground: 50, upper: 40 },
      "RCC with Mojaik": { ground: 35, upper: 25 },
      "RCC with IPS": { ground: 20, upper: 15 },
      "ASB/RTS/CIS with IPS": { ground: 6, upper: 6 }
    },
    rental: {
      "RCC with Marble": 1.5,
      "RCC with Mojaik": 1.0,
      "RCC with IPS": 0.6,
      "ASB/RTS/CIS with IPS": 0.4
    }
  };

  const landRates = {
    "1-44": {
      "less3.5": 6000,
      "3.5-7": 14000,
      "7.01-10": 20000,
      "10.01-15": 24000,
      "15.01+": 30000
    },
    "45-50": {
      "less3.5": 3000,
      "3.5-7": 7000,
      "7.01-10": 10000,
      "10.01-15": 12000,
      "15.01+": 15000
    }
  };

  const wardSelect = document.getElementById('wardNo');
  for(let i=1; i<=50; i++) {
    const opt = document.createElement('option');
    opt.value = i;
    opt.textContent = i;
    wardSelect.appendChild(opt);
  }

  function getPassageKey(val) {
    switch(val) {
      case "3.5": return "less3.5";
      case "3.5-7": return "3.5-7";
      case "7.01-10": return "7.01-10";
      case "10.01-15": return "10.01-15";
      case "15.01+": return "15.01+";
      default: return "less3.5";
    }
  }

  const floorsTableBody = document.querySelector("#floorsTable tbody");
  let floorCount = 0;

  function addFloor() {
    floorCount++;
    const tr = document.createElement('tr');

    tr.innerHTML = `
      <td>${floorCount}</td>
      <td>
        <select class="constructionType" onchange="updateRates(this)">
          <option value="">Select</option>
          <option value="RCC with Marble">RCC with Marble</option>
          <option value="RCC with Mojaik">RCC with Mojaik</option>
          <option value="RCC with IPS">RCC with IPS</option>
          <option value="ASB/RTS/CIS with IPS">ASB/RTS/CIS with IPS</option>
        </select>
      </td>
      <td>
        <select class="floorLevel" onchange="updateRates(this)">
          <option value="">Select</option>
          <option value="ground">Ground Floor</option>
          <option value="upper">1st & Above</option>
        </select>
      </td>
      <td><input type="number" class="area" min="0" value="0" oninput="updateTotals(this)" /></td>
      <td class="costRate">-</td>
      <td class="costTotal">0</td>
      <td class="rentalRate">-</td>
      <td class="rentalTotal">0</td>
      <td><button onclick="removeFloor(this)">Remove</button></td>
    `;

    floorsTableBody.appendChild(tr);
  }

  function removeFloor(button) {
    button.closest('tr').remove();
    recalcFloorNumbers();
  }

  function recalcFloorNumbers() {
    floorCount = 0;
    floorsTableBody.querySelectorAll('tr').forEach(tr => {
      floorCount++;
      tr.cells[0].textContent = floorCount;
    });
  }

  function updateRates(element) {
    const tr = element.closest('tr');
    const constructionType = tr.querySelector('.constructionType').value;
    const floorLevel = tr.querySelector('.floorLevel').value;
    const costRateCell = tr.querySelector('.costRate');
    const rentalRateCell = tr.querySelector('.rentalRate');
    const costTotalCell = tr.querySelector('.costTotal');
    const rentalTotalCell = tr.querySelector('.rentalTotal');
    const area = Number(tr.querySelector('.area').value) || 0;

    // Update cost rate
    let costRate = 0;
    if(constructionType && floorLevel) {
      if(constructionType === "ASB/RTS/CIS with IPS"){
        costRate = structureRates.cost[constructionType].ground; // ASB/RTS/CIS has same rate for ground/upper
      } else {
        costRate = structureRates.cost[constructionType][floorLevel] || 0;
      }
    }
    costRateCell.textContent = costRate ? costRate.toFixed(2) : '-';

    // Update rental rate
    let rentalRate = 0;
    if(constructionType) {
      rentalRate = structureRates.rental[constructionType] || 0;
    }
    rentalRateCell.textContent = rentalRate ? rentalRate.toFixed(2) : '-';

    // Update totals
    costTotalCell.textContent = (area * costRate).toFixed(2);
    rentalTotalCell.textContent = (area * rentalRate).toFixed(2);
  }

  function updateTotals(element) {
    const tr = element.closest('tr');
    const area = Number(element.value) || 0;
    const costRate = parseFloat(tr.querySelector('.costRate').textContent);
    const rentalRate = parseFloat(tr.querySelector('.rentalRate').textContent);

    if (!isNaN(costRate)) {
      tr.querySelector('.costTotal').textContent = (area * costRate).toFixed(2);
    }
    if (!isNaN(rentalRate)) {
      tr.querySelector('.rentalTotal').textContent = (area * rentalRate).toFixed(2);
    }
  }

  function calculate() {
    const floorRows = floorsTableBody.querySelectorAll('tr');

    let totalBuiltUpCost = 0;
    let totalBuiltUpRental = 0;

    // Collect floor details for output
    let floorDetailsHtml = `
      <h2>Detailed Floor Calculations</h2>
      <table>
        <thead>
          <tr>
            <th>Floor No.</th>
            <th>Construction Type</th>
            <th>Floor Level</th>
            <th>Area (sqft)</th>
            <th>Cost Rate (₹/sqft)</th>
            <th>Cost Total (₹)</th>
            <th>Rental Rate (₹/sqft)</th>
            <th>Rental Total (₹)</th>
          </tr>
        </thead>
        <tbody>
    `;

    floorRows.forEach((tr, i) => {
      const floorNo = i + 1;
      const constructionType = tr.querySelector('.constructionType').value || '-';
      const floorLevel = tr.querySelector('.floorLevel').value || '-';
      const floorLevelText = floorLevel === 'ground' ? 'Ground Floor' : (floorLevel === 'upper' ? '1st & Above' : '-');
      const area = Number(tr.querySelector('.area').value) || 0;
      const costRate = parseFloat(tr.querySelector('.costRate').textContent) || 0;
      const costTotal = parseFloat(tr.querySelector('.costTotal').textContent) || 0;
      const rentalRate = parseFloat(tr.querySelector('.rentalRate').textContent) || 0;
      const rentalTotal = parseFloat(tr.querySelector('.rentalTotal').textContent) || 0;

      totalBuiltUpCost += costTotal;
      totalBuiltUpRental += rentalTotal;

      floorDetailsHtml += `
        <tr>
          <td>${floorNo}</td>
          <td>${constructionType}</td>
          <td>${floorLevelText}</td>
          <td>${area.toFixed(2)}</td>
          <td>${costRate.toFixed(2)}</td>
          <td>${costTotal.toFixed(2)}</td>
          <td>${rentalRate.toFixed(2)}</td>
          <td>${rentalTotal.toFixed(2)}</td>
        </tr>
      `;
    });

    floorDetailsHtml += '</tbody></table>';

    // Land value (cost basis only)
    const landArea = Number(document.getElementById('landArea').value) || 0; // This value will now be auto-populated
    const ward = Number(document.getElementById('wardNo').value);
    const passage = document.getElementById('passageWidth').value;
    const passageKey = getPassageKey(passage);
    const wardGroup = (ward >= 1 && ward <= 44) ? "1-44" : "45-50";

    const ratePerKatha = landRates[wardGroup][passageKey] || 0;
    const kathas = landArea / SQFT_PER_KATHA; // Use the constant for sqft per katha

    const landValue = kathas * ratePerKatha;

    // Cost Basis annual value
    const annualCostValue = (totalBuiltUpCost + landValue) * 0.05; // Assuming 5% annual depreciation/return rate for Cost Basis

    // Rental Basis annual value (monthly rent × 12)
    const annualRentalValue = totalBuiltUpRental * 12;

    const landDetailsHtml = `
      <h2>Land Valuation Details (Cost Basis Only)</h2>
      <table>
        <tr><th>Land Area (sqft)</th><td>${landArea.toFixed(2)}</td></tr>
        <tr><th>Ward No.</th><td>${ward}</td></tr>
        <tr><th>Passage Width</th><td>${passage}</td></tr>
        <tr><th>Rate per Katha (₹)</th><td>${ratePerKatha.toFixed(2)}</td></tr>
        <tr><th>Total Land Value (₹)</th><td>${landValue.toFixed(2)}</td></tr>
      </table>
    `;

    // --- ENHANCED Summary Table with More Detailed Breakup ---
    const summaryHtml = `
      <h2>Summary of Valuation Methods</h2>
      <table>
        <thead>
          <tr>
            <th>Method</th>
            <th colspan="3">Details and Calculation</th>
            <th>Final Annual Value (₹)</th>
          </tr>
        </thead>
        <tbody>
          <tr class="section-header"><td colspan="5">Cost Basis Method</td></tr>
          <tr>
            <td rowspan="3">Cost Basis</td>
            <td style="text-align: left;">Total Built-Up Structure Cost</td>
            <td style="text-align: right;">₹ ${totalBuiltUpCost.toFixed(2)}</td>
            <td></td>
            <td rowspan="3" ${annualCostValue < annualRentalValue ? ' class="highlight"' : ''}>
              ${annualCostValue.toFixed(2)}
            </td>
          </tr>
          <tr>
            <td style="text-align: left;">Total Land Value</td>
            <td style="text-align: right;">₹ ${landValue.toFixed(2)}</td>
            <td></td>
          </tr>
          <tr>
            <td style="text-align: left;">Total Property Cost (Structure + Land) × 5%</td>
            <td style="text-align: right;">(₹ ${totalBuiltUpCost.toFixed(2)} + ₹ ${landValue.toFixed(2)}) × 0.05</td>
            <td style="text-align: right;">= ₹ ${ (totalBuiltUpCost + landValue).toFixed(2) } × 0.05</td>
          </tr>

          <tr class="section-header"><td colspan="5" style="padding-top: 20px;">Rental Basis Method</td></tr>
          <tr>
            <td rowspan="2">Rental Basis</td>
            <td style="text-align: left;">Total Built-Up Monthly Rental</td>
            <td style="text-align: right;">₹ ${totalBuiltUpRental.toFixed(2)}</td>
            <td></td>
            <td rowspan="2" ${annualRentalValue < annualCostValue ? ' class="highlight"' : ''}>
              ${annualRentalValue.toFixed(2)}
            </td>
          </tr>
          <tr>
            <td style="text-align: left;">Annual Rental Value (Monthly Rental × 12)</td>
            <td style="text-align: right;">₹ ${totalBuiltUpRental.toFixed(2)} × 12</td>
            <td style="text-align: right;">= ₹ ${ (totalBuiltUpRental * 12).toFixed(2) }</td>
          </tr>
        </tbody>
      </table>
    `;

    document.getElementById('result').innerHTML = floorDetailsHtml + landDetailsHtml + summaryHtml;
  }

  // --- Area Arithmetic Functions ---
  // The oninput event listener calls this function automatically when values change.
  function calculateArithmeticArea() {
    let bigha = parseFloat(document.getElementById('arithmeticBigha').value) || 0;
    let katha = parseFloat(document.getElementById('arithmeticKatha').value) || 0;
    let chattak = parseFloat(document.getElementById('arithmeticChattak').value) || 0;
    let sqft = parseFloat(document.getElementById('arithmeticSqft').value) || 0;

    // Convert all inputs to square feet and sum them
    let totalSqft =
        (bigha * SQFT_PER_BIGHA) +
        (katha * SQFT_PER_KATHA) +
        (chattak * SQFT_PER_CHATTAK) +
        sqft;

    document.getElementById('arithmeticResult').textContent = `Calculated Total Area: ${totalSqft.toFixed(2)} Sq.Ft.`;
    // Populate the Land Area (sqft) field with this result
    document.getElementById('landArea').value = totalSqft.toFixed(2);
  }

  // --- Rate Chart Display Functions ---
  function populateRateChart() {
    const structureTableBody = document.getElementById('structureRatesTable').querySelector('tbody');
    const landTableBody = document.getElementById('landRatesTable').querySelector('tbody');

    // Clear existing content
    structureTableBody.innerHTML = '';
    landTableBody.innerHTML = '';

    // Populate Structure Rates
    for (const type in structureRates.cost) {
      const row = structureTableBody.insertRow();
      row.insertCell().textContent = type;
      row.insertCell().textContent = structureRates.cost[type].ground.toFixed(2);
      // Special handling for ASB/RTS/CIS which has same upper rate as ground
      const upperCost = (type === "ASB/RTS/CIS with IPS") ? structureRates.cost[type].ground : structureRates.cost[type].upper;
      row.insertCell().textContent = upperCost.toFixed(2);
      row.insertCell().textContent = structureRates.rental[type].toFixed(2);
    }

    // Populate Land Rates
    // Get all passage keys in the correct order
    const passageKeys = ["less3.5", "3.5-7", "7.01-10", "10.01-15", "15.01+"];
    for (const wardGroup in landRates) {
      const row = landTableBody.insertRow();
      row.insertCell().textContent = `Ward ${wardGroup}`;
      passageKeys.forEach(key => {
        row.insertCell().textContent = landRates[wardGroup][key].toFixed(2);
      });
    }
  }

  function toggleRateChart() {
    const rateChartContainer = document.getElementById('rateChartContainer');
    if (rateChartContainer.style.display === 'none') {
      populateRateChart(); // Populate table data only when shown
      rateChartContainer.style.display = 'block';
    } else {
      rateChartContainer.style.display = 'none';
    }
  }


  // Initialize with one floor row when the page loads
  addFloor();
  // Call calculateArithmeticArea once to initialize the arithmetic result and landArea on page load
  calculateArithmeticArea();
</script>

</body>
</html>